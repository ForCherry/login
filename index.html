<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>ChatGPT Room</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<!-- <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/vant@4/lib/index.css"> -->
	<link rel="stylesheet" href="./css/vant4.css">
	<link rel="stylesheet" href="./css/1.css">
</head>

<body>
	<div class="container" id="app">
	</div>
	<!-- ç•Œé¢ -->
	<template id="t1">
		<div>
			<!-- <van-nav-bar title="æ ‡é¢˜" left-text="è¿”å›" left-arrow @click-left="onClickLeft" /> -->
			<h1>ChatGPT Room</h1>
			<!-- <div id="messages">
			</div> -->
			<div id="messages">
				<div class="message" hidden>
					<span>:ä½ </span>
					<p> ä½ å¥½ </p>
				</div>
				<div id="fa5e10e5-a74a-4717-b0a9-4b5a8215070a" class="message" class="gptBg">
					<span>ChatGpt:</span>
					<p id="fa5e10e5-a74a-4717-b0a9-4b5a8215070a"> ä½ å¥½ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©æ‚¨çš„å—ï¼Ÿ</p>
				</div>
			</div>
			<!--  -->

			<form id="message-form" class="form">
				<van-search v-model="value" show-action label="" placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜">
					<template #action>
						<van-button :loading="loading" type="primary" loading-type="spinner"
							@click="sendMessage(value)">å‘é€</van-button>
					</template>
				</van-search>
			</form>

			<van-toast v-model:show="loading" style="padding: 0px" position='bottom' :duration="0" forbidClick="true">
				<template #message>
					<!-- <van-image :src="image" width="200" height="140" style="display: block" /> -->
					<div id="closeBtn" @click.natvie="closeSSE">
						<van-button loading hairline type="primary" loading-text="æ€è€ƒä¸­..."></van-button>
						<!-- <van-button type="primary" @click="closeSSE()">å–æ¶ˆ</van-button> -->
						<!-- <span >å–æ¶ˆ</span> -->
					</div>
				</template>
			</van-toast>
		</div>
	</template>

	<script src="./js/vue@3"></script>
	<script src="./js/md.min.js"></script>
	<!-- <script src="./js/moment.js"></script> -->
	<script src="./js/jquery.min.js"></script>
	<script src="./js/eventsource.min.js"></script>
	<!-- <script src="./js/localforage.min.js"></script> -->
	<script src="./js/vant.min.js"></script>


	<script type="text/javascript">

		// åœ¨ #app æ ‡ç­¾ä¸‹æ¸²æŸ“ä¸€ä¸ªæŒ‰é’®ç»„ä»¶
		const app = Vue.createApp({
			template: "#t1",
			data() {
				return {
					value: "",
					loading: false,
					sse: "",
					eventSource: "",
					// session:""
					hasLocalforage: false,
				}
			},
			watch: {
				value(newV, oldV) {
					// console.log(newV, oldV);
					// this.value = newV.replace("`", '')
					// this.value = newV.replace(/[^u4e00-u9fa5w]/g, '')
				}

			},

			methods: {
				format() {
					const currentTime = new Date();
					const year = currentTime.getFullYear();
					const month = currentTime.getMonth() + 1;
					const day = currentTime.getDate();
					const hour = currentTime.getHours();
					const minute = currentTime.getMinutes();
					const second = currentTime.getSeconds();
					return `${year}/${month}/${day} ${hour}:${minute < 10 ? "0" + minute : minute}:${second < 10 ? "0" + second : second}`;
				},
				onClickLeft() {
					sessionStorage.clear()
					history.back();
				},

				closeSSE() {
					console.log("close");
					// console.log(this.eventSource, eventSource);
					eventSource._close()
					this.loading = false
					vant.showToast({ message: "æ‚¨æ‰“æ–­äº†æ€è€ƒğŸ¤”", position: 'bottom' })
				},
				// å‘é€èŠå¤©æ¶ˆæ¯
				sendMessage(message) {
					let that = this
					// $("#sumbit").setAttribute("loading")
					console.log("sendMessage");

					if (message == null || message == '' || message == 'null') {
						return vant.showDialog({ message: 'æ‚¨æš‚æœªè¾“å…¥ä»»ä½•å’’è¯­~' });
					}
					var messageDiv = document.createElement('div');
					var uuid_str = this.uuid();
					let sse;
					if (uid == null || uid == '' || uid == 'null') {
						uid = this.uuid();
					}
					// è®¾ç½®æœ¬åœ°å­˜å‚¨
					window.localStorage.setItem("uid", uid);

					// åœ¨æ­¤å¤„æ·»åŠ ä»£ç ï¼Œå°†æ¶ˆæ¯å‘é€åˆ°æœåŠ¡å™¨
					// console.log(eventSource);
					// http://localhost:8000/chat?message=
					// http://119.8.44.174:8000/chat?message=

					// vant.showLoadingToast('æ€è€ƒä¸­...');
					eventSource = new EventSourcePolyfill("http://119.8.44.174:8000/chat?message=" + message.toString(), {
						headers: {
							'Content-Type': 'text/event-stream',
							'Cache-Control': 'no-cache',
							'Connection': 'keep-alive',
							'X-Accel-Buffering': 'no',
							'uid': uid,
							// 'session':this.session || session
						},
						withCredentials: true,
						heartbeatTimeout: 120000,
						timeout: 120000
					});
					this.eventSource = eventSource;



					window.addEventListener('beforeunload', function (event) {
						// vant.closeToast();
						if (eventSource) {
							eventSource.close();
						}
						that.sendMessage(that.value)
						return vant.showDialog({ message: 'æ‚¨ç¦»å¼€äº†é¡µé¢ï¼Œæ­£åœ¨é‡è¿~' });

					});

					eventSource.onopen = function (event) {
						that.loading = true
						console.log('EventSource connected : onopen');
						sse = event.target;
						that.sse = sse
						messageDiv.classList.add('message');
						messageDiv.setAttribute("id", "User");
						// console.log(messageDiv);
						messageDiv.innerHTML = `<span><van-tag plain type="primary" class='tag'>(${that.format()})</van-tag>ä½  </span><p > ${message} </p>`;
						messagesDiv.appendChild(messageDiv);
						window.scrollTo(0, document.documentElement.scrollHeight)
					};

					eventSource.onmessage = function (event) {
						console.log('message', event);
						if (event.data == "[DONE]") {
							that.loading = false
							// closeToast();
							that.value = ""
							text = '';
							// æ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œå°†æ¶ˆæ¯å†™å…¥æ–‡æœ¬é¡µé¢ä¸­ï¼Œå¹¶æ¸…ç©ºæ¶ˆæ¯åˆ—è¡¨
							// æ£€æŸ¥æœ¬åœ°æ˜¯å¦æœ‰å­˜å‚¨çš„æ¶ˆæ¯ï¼Œå¦‚æœæœ‰ï¼Œåˆ™æ·»åŠ æœ¬åœ°å­˜å‚¨çš„æ¶ˆæ¯
							let messageDOM = document.getElementById("messages").innerHTML();
							console.log(messageDOM);
							localforage.setItem('chatDB', JSON.stringify(messageDOM)).then(function (value) {
								console.log(value);
								console.error("ä¿å­˜èŠå¤©è®°å½•æˆåŠŸ");
							}).catch(function (err) {
								// å½“å‡ºé”™æ—¶ï¼Œæ­¤å¤„ä»£ç è¿è¡Œ
								console.error("ä¿å­˜èŠå¤©è®°å½•å¤±è´¥", err);
							});

							window.scrollTo(0, document.documentElement.scrollHeight)
							if (sse) {
								console.log("DONE");
								sse.close();
							}
							return;
						}
						let json_data = JSON.parse(event.data)
						if (json_data.content == null || json_data.content == 'null') {
							text = '';
							return;
						}
						// text = text + json_data.content;
						text = json_data.content;
						console.log(text);
						that.receiveMessage(text, uuid_str);
						window.scrollTo(0, document.documentElement.scrollHeight)
					};

					eventSource.onerror = function (event) {
						// vant.closeToast();
						that.loading = false
						console.error('EventSource error:', event);
						// $("#sumbit").removeAttr("loading")
						if (event.status !== '401') {
							vant.showToast({ message: "æ‚¨ç™»é™†å¤±æ•ˆï¼Œè¯·é‡æ–°ç™»å½•", position: 'bottom' })
							window.location.href = "./login.html";
						}
						if (event.readyState === EventSource.CLOSED) {
							console.log('connection is closed');
						} else {
							console.log("Error occured", event);
						}
						eventSource._close();
						return vant.showDialog({ message: 'å½“å‰è®¿é—®äººæ•°è¿‡å¤šï¼Œè¯·ç¨åå†è¯•~' });
					};
				},
				/**
				 * æ¥å—æ•°æ®
				 */
				receiveMessage(text, uuid_str) {
					console.log(text, uuid_str);
					var messageDiv = document.getElementById(uuid_str);
					if (messageDiv == null) {
						messageDiv = document.createElement('div');
						messageDiv.setAttribute("id", uuid_str);
						messageDiv.classList.add('message');
						messageDiv.innerHTML = `<span>ChatGpt:<van-tag plain type="primary" class='tag'>(${that.format()})</van-tag></span><p class="typing" id='${uuid_str}'>  ${text}</p>`;
						messagesDiv.appendChild(messageDiv);
					} else {
						let p = messageDiv.getElementsByTagName('p')[0];
						p.innerHTML = p.innerHTML + text;

					}
					// messagesDiv.scrollTop = messagesDiv.scrollHeight;
				},
				uuid() {
					var s = [];
					var hexDigits = "0123456789abcdef";
					for (var i = 0; i < 36; i++) {
						s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
					}
					s[14] = "4"; // bits 12-15 of the time_hi_and_version field to 0010
					s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1); // bits 6-7 of the clock_seq_hi_and_reserved to 01
					s[8] = s[13] = s[18] = s[23] = "-";

					var uuid = s.join("");
					return uuid;
				},
			},
			watch: {
			},
			mounted() {
				let self = this
				document.onkeydown = function (e) {
					let ev = document.all ? window.event : e
					if (ev.keyCode === 13) {
						self.sendMessage(self.value)
					}
				}
			},
			created() {
				// console.log("inputVal ", this.inputVal);
				this.session = window.sessionStorage.getItem("session")
				console.log(this.session);
				if (!this.session) {
					vant.showDialog({ message: 'æœªæ£€æµ‹åˆ°ç™»é™†ç¦æ­¢è®¿é—®~' });
					window.location.href = "./login.html";
				} else {
// 					localforage.getItem('chatDB', function (err, value) {
// 						console.log("è·å–èŠå¤©è®°å½•");
// 						// å½“ç¦»çº¿ä»“åº“ä¸­çš„å€¼è¢«è½½å…¥æ—¶ï¼Œæ­¤å¤„ä»£ç è¿è¡Œ
// 						console.log(err, value);
// 						if (!value) {
// 							return
// 						}
// 						this.hasLocalforage = true;
// 						// è·å–id=messagesçš„å†…çš„htmlå†…å®¹
// 						let messageDOM = document.getElementById("messages");
// 						console.log(messageDOM);
// 						// æŠŠvalue æ·»åŠ åˆ° meesageDOMä¸­
// // 						messageDOM.innerHTML = `<div class="message" hidden=""><span>:ä½ </span><p> ä½ å¥½ </p></div><div id="fa5e10e5-a74a-4717-b0a9-4b5a8215070a" class="message"><span>ChatGpt:</span><p id="fa5e10e5-a74a-4717-b0a9-4b5a8215070a"> ä½ å¥½ï¼Œæœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©æ‚¨çš„å—ï¼Ÿ</p></div><div class="message" id="User"><span><van-tag plain="" type="primary" class="tag">(2023/4/5 13: 02: 59)</van-tag>ä½  </span><p> å‰ç«¯ä¿å­˜èŠå¤©è®°å½•çš„æ–¹æ³• </p></div><div id="7c8ef44a-4a2d-4382-bbe5-b6e4bec24b0a" class="message"><span>ChatGpt:</span><p id="7c8ef44a-4a2d-4382-bbe5-b6e4bec24b0a">  å‰ç«¯ä¿å­˜èŠå¤©è®°å½•çš„æ–¹æ³•æœ‰ä»¥ä¸‹å‡ ç§ï¼š

// // 1. ä½¿ç”¨æµè§ˆå™¨çš„æœ¬åœ°å­˜å‚¨ï¼ˆlocalStorageæˆ–sessionStorageï¼‰æ¥ä¿å­˜èŠå¤©è®°å½•ã€‚è¿™ç§æ–¹æ³•å¯ä»¥åœ¨ç”¨æˆ·å…³é—­æµè§ˆå™¨åä»ç„¶ä¿å­˜èŠå¤©è®°å½•ï¼Œä½†æ˜¯å­˜å‚¨å®¹é‡æœ‰é™ã€‚

// // 2. ä½¿ç”¨cookieæ¥ä¿å­˜èŠå¤©è®°å½•ã€‚è¿™ç§æ–¹æ³•å¯ä»¥åœ¨ç”¨æˆ·å…³é—­æµè§ˆå™¨åä»ç„¶ä¿å­˜èŠå¤©è®°å½•ï¼Œä½†æ˜¯å­˜å‚¨å®¹é‡ä¹Ÿæœ‰é™ã€‚

// // 3. ä½¿ç”¨æœåŠ¡å™¨ç«¯çš„æ•°æ®åº“æ¥ä¿å­˜èŠå¤©è®°å½•ã€‚è¿™ç§æ–¹æ³•å¯ä»¥ä¿å­˜å¤§é‡çš„èŠå¤©è®°å½•ï¼Œä½†éœ€è¦æœåŠ¡å™¨ç«¯çš„æ”¯æŒã€‚

// // 4. ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„äº‘å­˜å‚¨æœåŠ¡ï¼ˆå¦‚ä¸ƒç‰›äº‘ã€é˜¿é‡Œäº‘ç­‰ï¼‰æ¥ä¿å­˜èŠå¤©è®°å½•ã€‚è¿™ç§æ–¹æ³•å¯ä»¥ä¿å­˜å¤§é‡çš„èŠå¤©è®°å½•ï¼Œä½†éœ€è¦ä»˜è´¹ã€‚

// // éœ€è¦æ ¹æ®å…·ä½“çš„éœ€æ±‚å’Œåœºæ™¯é€‰æ‹©åˆé€‚çš„æ–¹æ³•æ¥ä¿å­˜èŠå¤©è®°å½•ã€‚</p></div><div class="message" id="User"><span><van-tag plain="" type="primary" class="tag">(2023/4/5 13: 04: 02)</van-tag>ä½  </span><p> localStorageå¯ä»¥ä¿å­˜å¤šå°‘å†…å­˜èŠå¤©è®°å½• </p></div><div id="31294b34-9103-420e-8f1f-3a008a7fb4ea" class="message"><span>ChatGpt:</span><p id="31294b34-9103-420e-8f1f-3a008a7fb4ea">  localStorageçš„å­˜å‚¨å®¹é‡æ˜¯æœ‰é™åˆ¶çš„ï¼Œé€šå¸¸ä¸º5MBå·¦å³ï¼Œå…·ä½“å®¹é‡å–å†³äºæµè§ˆå™¨çš„å®ç°ã€‚å› æ­¤ï¼Œå¦‚æœèŠå¤©è®°å½•è¿‡å¤šï¼Œè¶…å‡ºäº†localStorageçš„å®¹é‡é™åˆ¶ï¼Œå°±éœ€è¦è€ƒè™‘å…¶ä»–çš„å­˜å‚¨æ–¹å¼ï¼Œæ¯”å¦‚ä½¿ç”¨æœåŠ¡å™¨ç«¯çš„æ•°æ®åº“è¿›è¡Œå­˜å‚¨ã€‚</p></div><div class="message" id="User"><span><van-tag plain="" type="primary" class="tag">(2023/4/5 13: 04: 35)</van-tag>ä½  </span><p> localStorageä¿å­˜æ»¡äº†å¯ä»¥ç»§ç»­æ›¿æ¢å— </p></div><div id="ebb67d5c-45c6-45eb-b5b0-ec08178e4453" class="message"><span>ChatGpt:</span><p id="ebb67d5c-45c6-45eb-b5b0-ec08178e4453">  localStorageçš„å­˜å‚¨å®¹é‡æ˜¯æœ‰é™åˆ¶çš„ï¼Œä¸åŒæµè§ˆå™¨çš„é™åˆ¶ä¹Ÿä¸åŒï¼Œä¸€èˆ¬åœ¨5MBå·¦å³ã€‚å¦‚æœlocalStorageå·²ç»ä¿å­˜æ»¡äº†ï¼Œå°±ä¸èƒ½ç»§ç»­å¾€é‡Œé¢æ·»åŠ æ•°æ®äº†ã€‚å¦‚æœè¦ç»§ç»­ä¿å­˜èŠå¤©è®°å½•ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨IndexedDBæˆ–WebSQLç­‰å…¶ä»–çš„æµè§ˆå™¨æœ¬åœ°å­˜å‚¨æ–¹æ¡ˆï¼Œæˆ–è€…å°†èŠå¤©è®°å½•ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ã€‚å¦‚æœè¦æ›¿æ¢localStorageä¸­çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨setItem()æ–¹æ³•ï¼Œå°†æ–°çš„æ•°æ®è¦†ç›–æ‰æ—§çš„æ•°æ®ã€‚</p></div><div class="message" id="User"><span><van-tag plain="" type="primary" class="tag">(2023/4/5 13: 05: 32)</van-tag>ä½  </span><p> indexedDBæ€ä¹ˆä¿å­˜èŠå¤©è®°å½• </p></div><div id="7b03dcbe-fa40-4388-99ad-8b30259433db" class="message"><span>ChatGpt:</span><p id="7b03dcbe-fa40-4388-99ad-8b30259433db">  IndexedDBæ˜¯ä¸€ä¸ªæµè§ˆå™¨å†…ç½®çš„æ•°æ®åº“ï¼Œå¯ä»¥ç”¨æ¥ä¿å­˜å¤§é‡çš„æ•°æ®ï¼ŒåŒ…æ‹¬èŠå¤©è®°å½•ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ä»£ç ï¼Œç”¨äºä¿å­˜èŠå¤©è®°å½•åˆ°IndexedDBä¸­ï¼š

// // åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆæ‰“å¼€äº†ä¸€ä¸ªåä¸ºchatDBçš„æ•°æ®åº“ï¼Œå¹¶åˆ›å»ºäº†ä¸€ä¸ªåä¸ºchatçš„å­˜å‚¨å¯¹è±¡ã€‚ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªèŠå¤©è®°å½•å¯¹è±¡ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°chatå­˜å‚¨å¯¹è±¡ä¸­ã€‚å¦‚æœæ·»åŠ æˆåŠŸï¼Œå°±ä¼šåœ¨æ§åˆ¶å°è¾“å‡ºä¸€æ¡æˆåŠŸä¿¡æ¯ï¼Œå¦åˆ™ä¼šè¾“å‡ºä¸€æ¡é”™è¯¯ä¿¡æ¯ã€‚

// // IndexedDBå¯ä»¥ä¿å­˜å¤§é‡çš„æ•°æ®ï¼Œä½†å…·ä½“èƒ½ä¿å­˜å¤šå°‘å†…å­˜èŠå¤©è®°å½•å–å†³äºæµè§ˆå™¨å’Œè®¾å¤‡çš„æ€§èƒ½å’Œå­˜å‚¨å®¹é‡ã€‚å¦‚æœIndexedDBä¿å­˜æ»¡äº†ï¼Œå¯ä»¥é€šè¿‡åˆ é™¤æ—§çš„èŠå¤©è®°å½•æˆ–è€…ä½¿ç”¨å…¶ä»–å­˜å‚¨æ–¹å¼æ¥è§£å†³ã€‚</p></div><div class="message" id="User"><span><van-tag plain="" type="primary" class="tag">(2023/4/5 13: 09: 05)</van-tag>ä½  </span><p> ç§»åŠ¨ç«¯ä¹Ÿå¯ä»¥è¿™æ ·å— </p></div><div id="dba22187-1041-4fed-8e4a-661b4f7ed930" class="message"><span>ChatGpt:</span><p id="dba22187-1041-4fed-8e4a-661b4f7ed930">  æ˜¯çš„ï¼Œå‰ç«¯ä¿å­˜èŠå¤©è®°å½•çš„æ–¹æ³•åœ¨ç§»åŠ¨ç«¯ä¹Ÿæ˜¯é€‚ç”¨çš„ã€‚ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç§»åŠ¨ç«¯çš„å­˜å‚¨ç©ºé—´ç›¸å¯¹è¾ƒå°ï¼Œéœ€è¦è°¨æ…ä½¿ç”¨ï¼Œé¿å…å ç”¨è¿‡å¤šçš„å­˜å‚¨ç©ºé—´ã€‚åŒæ—¶ï¼Œç§»åŠ¨ç«¯çš„å­˜å‚¨æ–¹å¼å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œéœ€è¦æ ¹æ®å…·ä½“æƒ…å†µè¿›è¡Œé€‰æ‹©ã€‚ä¾‹å¦‚ï¼Œç§»åŠ¨ç«¯å¯ä»¥ä½¿ç”¨SQLiteæ•°æ®åº“æ¥ä¿å­˜èŠå¤©è®°å½•ã€‚</p></div><div class="message" id="User"><span><van-tag plain="" type="primary" class="tag">(2023/4/5 13: 09: 29)</van-tag>ä½  </span><p> SQLiteå¦‚ä½•ä¿å­˜å‘¢ </p></div><div id="6d1a9f3f-924f-45ce-8006-4bba3eafc722" class="message"><span>ChatGpt:</span><p id="6d1a9f3f-924f-45ce-8006-4bba3eafc722">  SQLiteæ˜¯ä¸€ç§è½»é‡çº§çš„å…³ç³»å‹æ•°æ®åº“ï¼Œå¯ä»¥åœ¨ç§»åŠ¨ç«¯ä½¿ç”¨ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨SQLiteä¿å­˜èŠå¤©è®°å½•çš„æ­¥éª¤ï¼š

// // 1. åˆ›å»ºæ•°æ®åº“å’Œè¡¨ï¼šä½¿ç”¨SQLiteOpenHelperç±»åˆ›å»ºæ•°æ®åº“å’Œè¡¨ï¼Œè¡¨ä¸­åŒ…å«èŠå¤©è®°å½•çš„å„ä¸ªå­—æ®µã€‚

// // 2. æ’å…¥æ•°æ®ï¼šä½¿ç”¨SQLiteDatabaseç±»çš„insert()æ–¹æ³•å‘è¡¨ä¸­æ’å…¥èŠå¤©è®°å½•ã€‚

// // 3. æŸ¥è¯¢æ•°æ®ï¼šä½¿ç”¨SQLiteDatabaseç±»çš„query()æ–¹æ³•æŸ¥è¯¢èŠå¤©è®°å½•ã€‚

// // 4. æ›´æ–°æ•°æ®ï¼šä½¿ç”¨SQLiteDatabaseç±»çš„update()æ–¹æ³•æ›´æ–°èŠå¤©è®°å½•ã€‚

// // 5. åˆ é™¤æ•°æ®ï¼šä½¿ç”¨SQLiteDatabaseç±»çš„delete()æ–¹æ³•åˆ é™¤èŠå¤©è®°å½•ã€‚

// // éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒSQLiteä¿å­˜çš„æ•°æ®æ˜¯ä»¥æ–‡ä»¶å½¢å¼å­˜å‚¨åœ¨è®¾å¤‡ä¸Šçš„ï¼Œå› æ­¤éœ€è¦æ³¨æ„æ•°æ®çš„å¤‡ä»½å’Œæ¢å¤ã€‚åŒæ—¶ï¼ŒSQLiteä¹Ÿæœ‰ä¸€å®šçš„å­˜å‚¨é™åˆ¶ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œä¼˜åŒ–å’Œç®¡ç†ã€‚</p></div><div class="message" id="User"><span><van-tag plain="" type="primary" class="tag">(2023/4/5 13: 10: 12)</van-tag>ä½  </span><p> IndexedDBå¯ä»¥ä¿å­˜å¤šå°‘å†…å­˜èŠå¤©è®°å½• </p></div><div id="0b5a96eb-8d46-404a-a87e-6f16903e88da" class="message"><span>ChatGpt:</span><p id="0b5a96eb-8d46-404a-a87e-6f16903e88da">  IndexedDBçš„å­˜å‚¨å®¹é‡æ˜¯æ²¡æœ‰é™åˆ¶çš„ï¼Œä½†æ˜¯ä¸åŒçš„æµè§ˆå™¨å¯¹IndexedDBçš„å­˜å‚¨å®¹é‡æœ‰ä¸åŒçš„é™åˆ¶ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒIndexedDBçš„å­˜å‚¨å®¹é‡åœ¨å‡ åMBåˆ°å‡ ç™¾MBä¹‹é—´ï¼Œå…·ä½“å®¹é‡å–å†³äºæµè§ˆå™¨å’Œè®¾å¤‡çš„ç¡¬ä»¶æ€§èƒ½ã€‚å¦‚æœéœ€è¦ä¿å­˜å¤§é‡çš„èŠå¤©è®°å½•ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨åˆ†é¡µæˆ–è€…å®šæœŸæ¸…ç†æ—§çš„èŠå¤©è®°å½•æ¥å‡å°‘IndexedDBçš„å­˜å‚¨å‹åŠ›ã€‚</p></div>`;
// 						messageDOM.innerHTML = JSON.parse(value)
// 		});
				}
			},
		});

		app.use(vant);
		// é€šè¿‡ CDN å¼•å…¥æ—¶ä¸ä¼šè‡ªåŠ¨æ³¨å†Œ Lazyload ç»„ä»¶
		// å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼æ‰‹åŠ¨æ³¨å†Œ
		// app.use(vant.Lazyload);
		app.mount('#app');
		// console.log(app);

		// è·å–DOMå…ƒç´ 
		var messageForm = document.getElementById('message-form');
		var messageInput = document.getElementById('message-input');
		var messagesDiv = document.getElementById('messages');
		let uid = window.localStorage.getItem("uid");
		var eventSource;
	</script>

</body>

</html>